{
  "hash": "bede00866c9927d32e41d22576b537e0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home_Ex01\"\nauthor: \"Yuheng Liang\"\nformat: html\neditor: visual\ndate: \"September 02, 2024\"\ndate-modified: \"September 08,2024\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n---\n\n\n\n# Take home ex01:**Geospatial Analytics for Social Good: Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar**\n\n## 1.0 Overview\n\n### 1.1 Objectives\n\nExercise Requirements:\n\n-   Using appropriate function of **sf** and **tidyverse** packages, import and transform the downloaded armed conflict data and administrative boundary data into sf tibble data.frames.\n-   Using the geospatial data sets prepared, derive quarterly KDE layers.\n-   Using the geospatial data sets prepared, perform 2nd-Order Spatial Point Patterns Analysis.\n-   Using the geospatial data sets prepared, derive quarterly spatio-temporal KDE layers.\n-   Using the geospatial data sets prepared, perform 2nd-Order Spatio-temporal Point Patterns Analysis.\n-   Using appropriate tmap functions, display the KDE and Spatio-temporal KDE layers on openstreetmap of Myanmar.\n-   Describe the spatial patterns revealed by the KDE and Spatio-temporal KDE maps.\n\n## 2.0 Setup\n\n### 2.1 Dependencies\n\n#### 2.1.1 Core Packages:\n\n-   SF: This package provides functions for reading, manipulating, and visualizing simple features geometries. It's essential for working with spatial data in R.\n-   tidyverse: A collection of packages including dplyr, ggplot2, and readr, provides a grammar of data manipulation. It's useful for data cleaning and transformation.\n-   dplyr:\n-   lubridate:\n-   spatstat:\n\n**Visualization Package:**\n\n-   tmap: Create thematic maps quickly and easily. It's ideal for visualizing spatial data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, sf, tmap, maptools, spatstat, spNetwork, classInt, viridis, arrow,dplyr,lubridate,spatstat,raster,Mass)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'Mass' is not available for this version of R\n\nA version of this package for your version of R might be available elsewhere,\nsee the ideas at\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Perhaps you meant 'MASS' ?\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: unable to access index for repository http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/4.4:\n  cannot open URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/4.4/PACKAGES'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 'BiocManager' not available.  Could not check Bioconductor.\n\nPlease use `install.packages('BiocManager')` and then retry.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in p_install(package, character.only = TRUE, ...):\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in library(package, lib.loc = lib.loc, character.only = TRUE,\nlogical.return = TRUE, : there is no package called 'Mass'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in pacman::p_load(tidyverse, sf, tmap, maptools, spatstat, spNetwork, : Failed to install/load:\nMass\n```\n\n\n:::\n:::\n\n\n\n### 2.2 Datasets\n\n-   **Armed conflict data**\n\n-   **GIS Data**\n\n## 3.0 Data warning\n\n### 3.1 Importing Armed conflict data\n\n-   Reads a CSV file named \"ACLED_Myanmar.csv\" and stores the data in a variable called acled_sf.\n-   Converts to spatial object\n-   Projects to a different coordinate system\n-   Converts date format\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- read_csv(\"data/ACLED_Myanmar.csv\")%>%\n  st_as_sf(coords =c(\"longitude\", \"latitude\"),crs=4326)%>%\n  st_transform(crs=32647)%>%\n  mutate(event_date =dmy(event_date))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 55574 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...\ndbl (11): year, time_precision, inter1, inter2, interaction, iso, latitude, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\ncheck data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 6 features and 29 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -206931.7 ymin: 1690159 xmax: 393190.2 ymax: 2444607\nProjected CRS: WGS 84 / UTM zone 47N\n# A tibble: 6 × 30\n  event_id_cnty event_date  year time_precision disorder_type         event_type\n  <chr>         <date>     <dbl>          <dbl> <chr>                 <chr>     \n1 MMR56099      2023-12-31  2023              1 Political violence    Explosion…\n2 MMR56222      2023-12-31  2023              1 Political violence    Explosion…\n3 MMR56370      2023-12-31  2023              1 Political violence    Battles   \n4 MMR56376      2023-12-31  2023              1 Demonstrations        Protests  \n5 MMR56380      2023-12-31  2023              1 Strategic developmen… Strategic…\n6 MMR56869      2023-12-31  2023              1 Strategic developmen… Strategic…\n# ℹ 24 more variables: sub_event_type <chr>, actor1 <chr>, assoc_actor_1 <chr>,\n#   inter1 <dbl>, actor2 <chr>, assoc_actor_2 <chr>, inter2 <dbl>,\n#   interaction <dbl>, civilian_targeting <chr>, iso <dbl>, region <chr>,\n#   country <chr>, admin1 <chr>, admin2 <chr>, admin3 <chr>, location <chr>,\n#   geo_precision <dbl>, source <chr>, source_scale <chr>, notes <chr>,\n#   fatalities <dbl>, tags <chr>, timestamp <dbl>, geometry <POINT [m]>\n```\n\n\n:::\n:::\n\n\n\nfiltered data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfiltered_acled_data <- acled_sf %>%\n  filter(event_date >= \"2021-01-01\" & event_date <= \"2024-06-30\")%>%\n  mutate(quarter = quarter(event_date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(filtered_acled_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 44,518\nColumns: 31\n$ event_id_cnty      <chr> \"MMR56099\", \"MMR56222\", \"MMR56370\", \"MMR56376\", \"MM…\n$ event_date         <date> 2023-12-31, 2023-12-31, 2023-12-31, 2023-12-31, 20…\n$ year               <dbl> 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 202…\n$ time_precision     <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ disorder_type      <chr> \"Political violence\", \"Political violence\", \"Politi…\n$ event_type         <chr> \"Explosions/Remote violence\", \"Explosions/Remote vi…\n$ sub_event_type     <chr> \"Shelling/artillery/missile attack\", \"Shelling/arti…\n$ actor1             <chr> \"Military Forces of Myanmar (2021-)\", \"Military For…\n$ assoc_actor_1      <chr> NA, NA, NA, NA, NA, NA, \"Daw Na Column; YGF: Ye Gue…\n$ inter1             <dbl> 1, 1, 3, 6, 1, 1, 3, 1, 2, 1, 1, 2, 2, 1, 1, 3, 3, …\n$ actor2             <chr> NA, \"Civilians (Myanmar)\", \"Military Forces of Myan…\n$ assoc_actor_2      <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ inter2             <dbl> 0, 7, 1, 0, 7, 0, 1, 0, 1, 7, 7, 1, 1, 0, 0, 1, 1, …\n$ interaction        <dbl> 10, 17, 13, 60, 17, 10, 13, 10, 12, 17, 17, 12, 12,…\n$ civilian_targeting <chr> NA, \"Civilian targeting\", NA, NA, NA, NA, NA, NA, N…\n$ iso                <dbl> 104, 104, 104, 104, 104, 104, 104, 104, 104, 104, 1…\n$ region             <chr> \"Southeast Asia\", \"Southeast Asia\", \"Southeast Asia…\n$ country            <chr> \"Myanmar\", \"Myanmar\", \"Myanmar\", \"Myanmar\", \"Myanma…\n$ admin1             <chr> \"Mon\", \"Rakhine\", \"Bago-West\", \"Sagaing\", \"Bago-Wes…\n$ admin2             <chr> \"Mawlamyine\", \"Maungdaw\", \"Thayarwady\", \"Yinmarbin\"…\n$ admin3             <chr> \"Ye\", \"Maungdaw\", \"Nattalin\", \"Salingyi\", \"Nattalin…\n$ location           <chr> \"Aing Shey\", \"Kaing Gyi (NaTaLa)\", \"Kyauk Pyoke\", \"…\n$ geo_precision      <dbl> 1, 2, 2, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, …\n$ source             <chr> \"Democratic Voice of Burma\", \"Development Media Gro…\n$ source_scale       <chr> \"National\", \"Subnational\", \"National\", \"National\", …\n$ notes              <chr> \"On 31 December 2023, in Aing Shey village (Ye town…\n$ fatalities         <dbl> 0, 0, 4, 0, 0, 0, 3, 0, 0, 0, 1, 0, 0, 0, 0, 1, 2, …\n$ tags               <chr> NA, NA, NA, \"crowd size=no report\", NA, NA, NA, NA,…\n$ timestamp          <dbl> 1704831212, 1704831213, 1704831214, 1704831214, 170…\n$ geometry           <POINT [m]> POINT (393190.2 1690159), POINT (-183852.6 23…\n$ quarter            <int> 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, …\n```\n\n\n:::\n:::\n\n\nset new dataset by season\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseasonal_data <- filtered_acled_data %>%\n  group_by(quarter) %>%\n  group_split()\n\nq1_data <- seasonal_data[[1]]\nq2_data <- seasonal_data[[2]]\nq3_data <- seasonal_data[[3]]\nq4_data <- seasonal_data[[4]]\n```\n:::\n\n\n\n### 3.2 Importing GIS Data\n\nImporting polygon feature data in shapefile format\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboundry <- st_read(dsn = \"data/mmr_polbnda_adm1_250k_mimu_1\", layer = \"mmr_polbnda_adm1_250k_mimu_1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda_adm1_250k_mimu_1' from data source \n  `D:\\Maaaaaaaaaark\\IS415-GEO\\Take-home_Ex\\Take-home_Ex01\\data\\mmr_polbnda_adm1_250k_mimu_1' \n  using driver `ESRI Shapefile'\nSimple feature collection with 15 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n:::\n\n\n\nData inspection and visualisation\n\nView Data Structures\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(boundary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nfunction (type = c(\"character\", \"line_break\", \"sentence\", \"word\"), skip_word_none = NA, \n    ...)  \n```\n\n\n:::\n:::\n\n\n\nVies crs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(boundary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System: NA\n```\n\n\n:::\n:::\n\n\n\ntransform data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboundary_transformed <- st_transform(boundry,crs = 32647)\n```\n:::\n\n\n\ncheck the data after transform\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(boundary_transformed)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: EPSG:32647 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 47N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 47N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",99,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand.\"],\n        BBOX[0,96,84,102]],\n    ID[\"EPSG\",32647]]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(boundary_transformed)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 15\nColumns: 7\n$ OBJECTID <dbl> 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 18\n$ ST       <chr> \"Ayeyarwady\", \"Bago\", \"Chin\", \"Kachin\", \"Kayah\", \"Kayin\", \"Ma…\n$ ST_PCODE <chr> \"MMR017\", \"MMR111\", \"MMR004\", \"MMR001\", \"MMR002\", \"MMR003\", \"…\n$ ST_RG    <chr> \"Region\", \"Region\", \"State\", \"State\", \"State\", \"State\", \"Regi…\n$ ST_MMR   <chr> \"ဧရာဝတီတိုင်းဒေသကြီး\", \"ပဲခူးတိုင်းဒေသကြီး\", \"ချင်းပြည်နယ်\", \"ကချင်ပြည်နယ်\", \"…\n$ PCode_V  <dbl> 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9.4, 9…\n$ geometry <MULTIPOLYGON [m]> MULTIPOLYGON (((93411.72 17..., MULTIPOLYGON (((203949.9 21..…\n```\n\n\n:::\n:::\n\n\n\nvisualisation the boundary_transformed\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(boundary_transformed)+geom_sf()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n### 3.3 Geospatial Data wrangling\n#### 3.3.1 Converting sf data frames to sp’s Spatial* class\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq1 <- as_Spatial(q1_data)\n```\n:::\n\n\ndisplay\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(q1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  event_id_cnty event_date year time_precision      disorder_type\n1      MMR46660 2023-03-31 2023              1 Political violence\n2      MMR46662 2023-03-31 2023              1 Political violence\n3      MMR46663 2023-03-31 2023              1 Political violence\n4      MMR46664 2023-03-31 2023              1 Political violence\n5      MMR46872 2023-03-31 2023              1 Political violence\n6      MMR46874 2023-03-31 2023              1 Political violence\n                  event_type                    sub_event_type\n1 Violence against civilians                            Attack\n2 Violence against civilians                            Attack\n3 Violence against civilians                            Attack\n4 Explosions/Remote violence Shelling/artillery/missile attack\n5                    Battles                       Armed clash\n6                    Battles                       Armed clash\n                                                                 actor1\n1                                      Police Forces of Myanmar (2021-)\n2                                    Military Forces of Myanmar (2021-)\n3                                    Military Forces of Myanmar (2021-)\n4                                    Military Forces of Myanmar (2021-)\n5 Yinmarbin Myo Pya Pyauk Kyar Tatphwe: Yinmarbin Urban Guerrilla Force\n6                                    Military Forces of Myanmar (2021-)\n  assoc_actor_1 inter1                             actor2 assoc_actor_2 inter2\n1          <NA>      1                Civilians (Myanmar)          <NA>      7\n2          <NA>      1                Civilians (Myanmar)          <NA>      7\n3          <NA>      1                Civilians (Myanmar)          <NA>      7\n4          <NA>      1                               <NA>          <NA>      0\n5          <NA>      3 Military Forces of Myanmar (2021-)          <NA>      1\n6          <NA>      1 Unidentified Anti-Coup Armed Group          <NA>      3\n  interaction civilian_targeting iso         region country  admin1\n1          17 Civilian targeting 104 Southeast Asia Myanmar  Yangon\n2          17 Civilian targeting 104 Southeast Asia Myanmar Sagaing\n3          17 Civilian targeting 104 Southeast Asia Myanmar  Kachin\n4          10               <NA> 104 Southeast Asia Myanmar  Kachin\n5          13               <NA> 104 Southeast Asia Myanmar Sagaing\n6          13               <NA> 104 Southeast Asia Myanmar Sagaing\n        admin2  admin3      location geo_precision                    source\n1 Yangon-South   Kayan Swei Taw Kwin             2 Democratic Voice of Burma\n2       Shwebo    Ye-U  Kyar Pan Nyo             1                       VOA\n3      Mohnyin Hpakant       Kamaing             1 Ministry of Defense - NUG\n4        Bhamo  Shwegu      Man Wein             1               Myanmar Now\n5    Yinmarbin    Pale          Pale             2 Democratic Voice of Burma\n6        Katha Banmauk  Pin Hin Khar             1 Democratic Voice of Burma\n   source_scale\n1      National\n2 International\n3      National\n4      National\n5      National\n6      National\n                                                                                                                                                                                                                                                                                                                                                                notes\n1 On 31 March 2023, between Swei Taw Kwin and Day Pauk villages (coded as Swei Taw Kwin) (Kayan township, Yangon-South district, Yangon region), the police fired two gunshots and killed a local on the road heading to Swei Taw Kwin village at around 1:30 pm. The military claimed to have seized a mobile phone, 20,000 MMks, and a grenade in the victim's bag.\n2                                                                                                                                                                    On 31 March 2023, in Kyar Pan Nyo village (Ye-U township, Shwebo district, Sagaing region), about 100 military soldiers raided the village by opening fire at around 10 am, injuring two locals.\n3                                                                                                                                         On 31 March 2023, in Kamaing town (Hpakant township, Mohnyin district, Kachin state), the military intercepted a car and shot and killed a passenger after interrogating him at the military checking point at around 2 pm.\n4                                                                                                                                       On 31 March 2023, in Man Wein village (Shwegu township, Bhamo district, Kachin state), the military stationed in the village monastery fired artillery rounds indiscriminately starting from around 5 am. Casualties unknown.\n5                                                                                                                            On 31 March 2023, near Pale town (Pale township, Yinmarbin district, Sagaing region), the Yinmarbin Urban Guerrilla Force attacked the military stationed at the check point near the town entrance with small guns. Casualties unknown.\n6                                                                                 On 31 March 2023, in Pin Hin Khar village (Banmauk township, Katha district, Sagaing region), the military engaged in intense fighting with the local PDFs. Two IDP civilians on a motorcycle who drove by hit stray bullets. The male rider was killed and his mother was injured.\n  fatalities tags  timestamp quarter\n1          1 <NA> 1680622877       1\n2          0 <NA> 1680622877       1\n3          1 <NA> 1680622877       1\n4          0 <NA> 1680622877       1\n5          0 <NA> 1681314030       1\n6          1 <NA> 1681314030       1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nq2 <- as_Spatial(q2_data)\nq3 <- as_Spatial(q3_data)\nq4 <- as_Spatial(q4_data)\n```\n:::\n\n\n\n#### 3.3.2 Converting the Spatial* class into generic sp format\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq1_sp <- as(q1,\"SpatialPoints\")\nq2_sp <- as(q2,\"SpatialPoints\")\nq3_sp <- as(q3,\"SpatialPoints\")\nq4_sp <- as(q4,\"SpatialPoints\")\n```\n:::\n\n\n\n\ndisplay shows below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq1_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass       : SpatialPoints \nfeatures    : 10979 \nextent      : -204784, 591875.9, 1103500, 3042960  (xmin, xmax, ymin, ymax)\ncrs         : +proj=utm +zone=47 +datum=WGS84 +units=m +no_defs \n```\n\n\n:::\n:::\n\n\n\n#### 3.3.3 Converting the generic sp format into spatstat’s ppp format\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq1_ppp <- as.ppp(st_coordinates(q1_data), st_bbox(q1_data))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n```{.r .cell-code}\nq2_ppp <- as.ppp(st_coordinates(q2_data), st_bbox(q2_data))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n```{.r .cell-code}\nq3_ppp <- as.ppp(st_coordinates(q3_data), st_bbox(q3_data))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n\n```{.r .cell-code}\nq4_ppp <- as.ppp(st_coordinates(q4_data), st_bbox(q4_data))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n:::\n\n\n\n#### 3.3.4 Handling duplicated point\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(q1_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(q2_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(q3_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(q4_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\njittering approach\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq1_ppp_jit <- rjitter(q1_ppp,retry=TRUE,nsim=1,drop=TRUE)\nq2_ppp_jit <- rjitter(q2_ppp,retry=TRUE,nsim=1,drop=TRUE)\nq3_ppp_jit <- rjitter(q3_ppp,retry=TRUE,nsim=1,drop=TRUE)\nq4_ppp_jit <- rjitter(q4_ppp,retry=TRUE,nsim=1,drop=TRUE)\n```\n:::\n\n\n\ncheck if any duplicayed points in this geospatial data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(q1_ppp_jit))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(q2_ppp_jit))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(q3_ppp_jit))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n\n```{.r .cell-code}\nany(duplicated(q4_ppp_jit))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n\n#### 3.3.5 Creating owin object\ncovert sgSpatialPolygon object into owin object of spatstat\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboundary_owin <- as.owin(boundary_transformed)\n```\n:::\n\n\ndisplay\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(boundary_owin)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n#### 3.3.6 combining point events object and owin object\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacledmy_ppp_q1 = q1_ppp[boundary_owin]\nacledmy_ppp_q2 = q2_ppp[boundary_owin]\nacledmy_ppp_q3 = q3_ppp[boundary_owin]\nacledmy_ppp_q4 = q4_ppp[boundary_owin]\n```\n:::\n\n\n\n## 4.0 derive quarterly KDE layers\n### 4.1 q1\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"MASS\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: unable to access index for repository http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/4.4:\n  cannot open URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/4.4/PACKAGES'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\npackage 'MASS' successfully unpacked and MD5 sums checked\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: cannot remove prior installation of package 'MASS'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in file.copy(savedcopy, lib, recursive = TRUE): problem copying\nD:\\R_Program\\R-4.4.1\\library\\00LOCK\\MASS\\libs\\x64\\MASS.dll to\nD:\\R_Program\\R-4.4.1\\library\\MASS\\libs\\x64\\MASS.dll: Permission denied\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: restored 'MASS'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nThe downloaded binary packages are in\n\tC:\\Windows\\Temp\\Rtmp2Lsi2n\\downloaded_packages\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(MASS)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'MASS'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:raster':\n\n    area, select\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:spatstat.geom':\n\n    area\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n\n\n:::\n\n```{.r .cell-code}\nfor (q in 1) {\n  \n  # 提取坐标点\n  coordinates <- st_coordinates(q1_data)\n  lon <- coordinates[, 1]  # 经度\n  lat <- coordinates[, 2]  # 纬度\n  \n  # 生成 KDE\n  kde <- kde2d(lon, lat, n = 200)\n  \n  # 转换为 raster 并可视化\n  kde_raster <- raster(kde)\n  plot(kde_raster, main = paste(\"KDE for Quarter 1\"))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n### 4.2 q2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (q in 1) {\n  \n  # 提取坐标点\n  coordinates <- st_coordinates(q2_data)\n  lon <- coordinates[, 1]  # 经度\n  lat <- coordinates[, 2]  # 纬度\n  \n  # 生成 KDE\n  kde <- kde2d(lon, lat, n = 200)\n  \n  # 转换为 raster 并可视化\n  kde_raster <- raster(kde)\n  plot(kde_raster, main = paste(\"KDE for Quarter 2\"))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n### 4.3 q3\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (q in 1) {\n  \n  # 提取坐标点\n  coordinates <- st_coordinates(q3_data)\n  lon <- coordinates[, 1]  # 经度\n  lat <- coordinates[, 2]  # 纬度\n  \n  # 生成 KDE\n  kde <- kde2d(lon, lat, n = 500)\n  \n  # 转换为 raster 并可视化\n  kde_raster <- raster(kde)\n  plot(kde_raster, main = paste(\"KDE for Quarter 3\"))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n### 4.4 q4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (q in 1) {\n  \n  # 提取坐标点\n  coordinates <- st_coordinates(q4_data)\n  lon <- coordinates[, 1]  # 经度\n  lat <- coordinates[, 2]  # 纬度\n  \n  # 生成 KDE\n  kde <- kde2d(lon, lat, n = 1000)\n  \n  # 转换为 raster 并可视化\n  kde_raster <- raster(kde)\n  plot(kde_raster, main = paste(\"KDE for Quarter 4\"))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n## 5.0 perform 2nd-Order Spatial Point Patterns Analysis\nFor a comprehensive analysis of the clustering or dispersion of armed conflict events in Myanmar on a region-wide scale for the period 2021-2024, I recommend the use of K-functions or L-functions. They provide information on clustering or dispersion at different distance scales on a global scale.\n### 5.1 data examination\nChecking whether a point pattern data is valid\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(q1_ppp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPlanar point pattern:  10979 points\nAverage intensity 7.105734e-09 points per square unit\n\n*Pattern contains duplicated points*\n\nCoordinates are given to 13 decimal places\n\nWindow: rectangle = [-204784, 591875.9] x [1103500.1, 3042960.3] units\n                    (796700 x 1939000 units)\nWindow area = 1.54509e+12 square units\n```\n\n\n:::\n:::\n\n\n### 5.2  Computing K-fucntion estimate\n\n\n::: {.cell}\n\n```{.r .cell-code}\nK_q1 <- Kest(q1_ppp,correction = \"Ripley\")\nK_q2 <- Kest(q2_ppp,correction = \"Ripley\")\nK_q3 <- Kest(q3_ppp,correction = \"Ripley\")\nK_q4 <- Kest(q4_ppp,correction = \"Ripley\")\n```\n:::\n\n\ndisplay\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(K_q1, . -r ~ r, ylab= \"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(K_q2, . -r ~ r, ylab= \"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-32-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(K_q3, . -r ~ r, ylab= \"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-32-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(K_q4, . -r ~ r, ylab= \"K(d)-r\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-32-4.png){width=672}\n:::\n:::\n\n\n### 5.3 Computing L-fucntion estimate\n\n\n::: {.cell}\n\n```{.r .cell-code}\nL1_ck <- Lest(q1_ppp, correction = \"Ripley\")\nL2_ck <- Lest(q2_ppp, correction = \"Ripley\")\nL3_ck <- Lest(q3_ppp, correction = \"Ripley\")\nL4_ck <- Lest(q4_ppp, correction = \"Ripley\")\n```\n:::\n\n\ndisplay\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(L1_ck, . -r ~ r)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(L2_ck, . -r ~ r)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-34-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(L3_ck, . -r ~ r)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-34-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(L4_ck, . -r ~ r)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-34-4.png){width=672}\n:::\n:::\n\n\n### 5.4  Computing F-fucntion estimate\n\n\n::: {.cell}\n\n```{.r .cell-code}\nF1_ck = Fest(q1_ppp)\nF2_ck = Fest(q2_ppp)\nF3_ck = Fest(q3_ppp)\nF4_ck = Fest(q4_ppp)\n```\n:::\n\n\ndiasplay\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(F1_ck)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(F2_ck)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(F3_ck)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(F4_ck)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-36-4.png){width=672}\n:::\n:::\n\n\n### 5.5 Computing G-fucntion estimate\n\n\n::: {.cell}\n\n```{.r .cell-code}\nG1_ck = Gest(q1_ppp, correction = \"border\")\nG2_ck = Gest(q2_ppp, correction = \"border\")\nG3_ck = Gest(q3_ppp, correction = \"border\")\nG4_ck = Gest(q4_ppp, correction = \"border\")\n```\n:::\n\n\ndisplay\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(G1_ck)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(G2_ck)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-38-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(G3_ck)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-38-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(G4_ck)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-38-4.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}